<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Report - Ignis Divinus</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --fire-orange: #ff6b35;
            --fire-yellow: #ffcc00;
            --fire-red: #c41e3a;
            --bg-dark: #0a0a0a;
            --text-light: #f0f0f0;
            --accent-blue: #4a90e2;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, var(--fire-orange), var(--fire-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #999;
            margin-bottom: 20px;
        }

        .url-box {
            text-align: center;
            margin-bottom: 20px;
            padding: 8px;
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid var(--fire-orange);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        h2 {
            color: var(--fire-orange);
            margin: 25px 0 12px;
            font-size: 1.6rem;
            border-bottom: 1px solid rgba(255, 107, 53, 0.3);
            padding-bottom: 5px;
        }

        h3 {
            color: var(--fire-yellow);
            margin: 18px 0 8px;
            font-size: 1.2rem;
        }

        p {
            margin-bottom: 12px;
            color: #ddd;
            text-align: justify;
        }

        ul {
            margin-left: 20px;
            margin-bottom: 12px;
        }

        li {
            margin-bottom: 6px;
            color: #ddd;
        }

        .team {
            text-align: center;
            margin: 15px 0;
            font-size: 0.95rem;
        }

        .abstract-box {
            background: rgba(255, 107, 53, 0.05);
            border-left: 3px solid var(--fire-orange);
            padding: 15px;
            margin: 15px 0;
            font-size: 0.95rem;
        }

        .result-img {
            max-width: 400px;
            width: 100%;
            margin: 15px auto;
            display: block;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .metric {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
        }

        .metric-value {
            font-size: 1.3rem;
            color: var(--fire-yellow);
            font-weight: bold;
        }

        .contributions {
            background: rgba(155, 89, 182, 0.05);
            border: 1px solid rgba(155, 89, 182, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .contributions p {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .references {
            font-size: 0.9rem;
            color: #bbb;
        }

        .references p {
            margin-bottom: 5px;
        }

        .comparison-table {
            width: 100%;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparison-table th {
            color: var(--fire-yellow);
        }
    </style>
</head>
<body>
    <div style="text-align: left; margin-bottom: 20px;">
        <a href="index.html" style="color: var(--fire-orange); text-decoration: none; font-weight: bold;">← Back to Home</a>
    </div>
    
    <h1>Ignis Divinus</h1>
    <p class="subtitle">Final Report - CS 184 Summer 2025</p>
    
    <div class="url-box">
        <strong>Project Website:</strong> https://yijun-xiang.github.io/ignis-divinus/final.html
    </div>
    
    <div style="text-align: center; margin-bottom: 20px; padding: 10px; background: rgba(74, 144, 226, 0.1); border: 1px solid var(--accent-blue); border-radius: 8px;">
        For extended technical documentation with additional implementation details and complete analysis:<br>
        <a href="final-full.html" style="color: var(--accent-blue); text-decoration: none; font-weight: bold;">
            View Full Technical Report →
        </a>
    </div>

    <div class="team">
        Chenyang Zhang | Huachen Qu | Muze Du | Yijun Xiang
    </div>

    <h2>Abstract</h2>
    <div class="abstract-box">
        <p>
            We present <strong>Ignis Divinus</strong>, a real-time 3D fire simulation system that achieves physically realistic flame behavior through GPU-accelerated fluid dynamics. Our implementation combines stable Navier-Stokes fluid simulation with volumetric rendering techniques, leveraging Taichi's differentiable programming framework for high-performance computation. The system features a Semi-Lagrangian advection scheme for stability, temperature-driven buoyancy for natural flame motion, and physically-based blackbody radiation for accurate color representation. We achieved interactive frame rates of 30+ FPS at 96³ grid resolution on consumer GPUs, with advanced post-processing effects including bloom and heat refraction.
        </p>
    </div>

    <h2>Technical Approach</h2>
    
    <h3>Core Simulation Architecture</h3>
    <p>
        Our fire simulation system is built on a 3D grid-based fluid solver implementing the incompressible Navier-Stokes equations. We chose a Semi-Lagrangian advection scheme for its unconditional stability, allowing larger time steps without numerical explosion. The simulation operates on a staggered MAC (Marker-And-Cell) grid where velocity components are stored at cell faces and scalar quantities (density, temperature) at cell centers. The core solver performs these steps each frame:
    </p>
    <ul>
        <li><strong>Advection:</strong> Semi-Lagrangian backward particle trace for stability</li>
        <li><strong>Buoyancy:</strong> Temperature-driven forces using α(ρ - ρ₀) + β(T - T₀)</li>
        <li><strong>Pressure Projection:</strong> 40 Jacobi iterations to enforce incompressibility</li>
        <li><strong>Dissipation:</strong> Per-second rates for velocity (20/s), density (1/s), temperature (1/s)</li>
    </ul>

    <h3>Rendering Pipeline</h3>
    <p>
        We implemented a ray marching-based volume renderer that directly integrates emission and absorption along view rays. The renderer uses physically-based blackbody radiation to map temperature values to colors. Key innovations include:
    </p>
    <ul>
        <li>256-step adaptive ray marching with early termination when opacity > 0.95</li>
        <li>Blackbody radiation lookup table for temperatures 800K-3000K</li>
        <li>Emission-absorption model: L = L₀e^(-κρt) + ε(1 - e^(-κρt))</li>
        <li>Screen-space heat refraction using temperature gradient displacement</li>
    </ul>

    <h3>Comparison with Reference Approaches</h3>
    <table class="comparison-table">
        <tr>
            <th>Aspect</th>
            <th>Reference (Stam 1999)</th>
            <th>Our Implementation</th>
        </tr>
        <tr>
            <td>Grid Resolution</td>
            <td>32³ - 64³</td>
            <td>96³ - 128³</td>
        </tr>
        <tr>
            <td>Advection</td>
            <td>Semi-Lagrangian</td>
            <td>Semi-Lagrangian + CFL adaptive</td>
        </tr>
        <tr>
            <td>Rendering</td>
            <td>Simple density mapping</td>
            <td>Blackbody radiation model</td>
        </tr>
        <tr>
            <td>Performance</td>
            <td>~10 FPS (CPU)</td>
            <td>30+ FPS (GPU/Taichi)</td>
        </tr>
    </table>

    <h3>Challenges and Solutions</h3>
    <p>
        <strong>Problem 1: Numerical Instability.</strong> Initial implementation suffered from velocity field explosion at high temperatures. We solved this by implementing Semi-Lagrangian advection with CFL-based adaptive time stepping (dt = min(0.066, 0.5 * dx/|v|_max)) and added numerical dissipation.
    </p>
    <p>
        <strong>Problem 2: Unrealistic Flame Motion.</strong> Flames appeared too laminar. We added vorticity confinement (ε = 6.0) to restore small-scale rotational motion lost to numerical dissipation, and introduced stochastic fuel injection for natural flickering.
    </p>
    <p>
        <strong>Problem 3: Performance Bottlenecks.</strong> Initial ray marcher achieved only 5-10 FPS. We implemented adaptive step sizes, early termination, and moved all computation to GPU kernels via Taichi, achieving 6x performance improvement.
    </p>

    <h3>Lessons Learned</h3>
    <ul>
        <li><strong>Stability vs Accuracy Trade-off:</strong> Semi-Lagrangian methods sacrifice some accuracy for unconditional stability, but this is acceptable for visual applications where stability is paramount.</li>
        <li><strong>Importance of Physical Models:</strong> Using blackbody radiation for color mapping made a dramatic difference in realism compared to ad-hoc color gradients.</li>
        <li><strong>GPU Memory Patterns Matter:</strong> Coalesced memory access patterns in Taichi kernels provided 2-3x speedup over naive implementations.</li>
        <li><strong>Post-processing Impact:</strong> Simple effects like bloom and heat refraction contribute disproportionately to perceived quality with minimal performance cost.</li>
    </ul>

    <h2>Results</h2>
    
    <div class="metrics">
        <div class="metric">
            <div class="metric-value">96³</div>
            <div>Grid Resolution</div>
        </div>
        <div class="metric">
            <div class="metric-value">30-60</div>
            <div>FPS Range</div>
        </div>
        <div class="metric">
            <div class="metric-value">256</div>
            <div>Ray Steps</div>
        </div>
        <div class="metric">
            <div class="metric-value">6x</div>
            <div>GPU Speedup</div>
        </div>
    </div>

    <p>
        Our system achieves real-time performance across multiple quality presets. At high quality (96³ grid, 256 ray steps), we maintain 30+ FPS while producing visually compelling fire effects. The frame time breakdown shows: Fluid Simulation (40%), Volume Rendering (50%), Post-processing (7%), Other (3%).
    </p>
    
    <div style="margin: 20px 0; padding: 15px; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
        <p style="margin-bottom: 10px;"><strong>📹 Demo Video:</strong> <a href="https://drive.google.com/file/d/1DYp5ZlH3U0DpFxJQEXef2onEMBGBQo66/view" style="color: var(--accent-blue); text-decoration: none;">View full demonstration with wind effects and color variations</a></p>
        <p style="margin-bottom: 0;"><strong>📊 Presentation:</strong> <a href="slides.html" style="color: var(--accent-blue); text-decoration: none;">View project slides</a></p>
    </div>

    <h2>Team Contributions</h2>
    <div class="contributions">
        <p><strong>Chenyang Zhang:</strong> Developed Jacobi pressure solver with 80 iterations. Implemented buoyancy forces and boundary conditions. Conducted fluid dynamics algorithm research.</p>
        <p><strong>Huachen Qu:</strong> Built VolumeRenderer with 256-step ray marching. Implemented blackbody radiation LUT (800-3000K). Designed emission-absorption model.</p>
        <p><strong>Muze Du:</strong> Co-implemented Fluid3D class with fuel combustion system. Created HeatRefraction effects and PostProcessor pipeline with bloom.</p>
        <p><strong>Yijun Xiang:</strong> Designed main.py system architecture. Led Taichi GPU integration achieving 30+ FPS. Developed adaptive timestep control.</p>
    </div>

    <h2>References</h2>
    <div class="references">
        <p>[1] Stam, Jos. "Stable Fluids." SIGGRAPH 1999.</p>
        <p>[2] Fedkiw, Ronald, Jos Stam, and Henrik Wann Jensen. "Visual Simulation of Smoke." SIGGRAPH 2001.</p>
        <p>[3] Nguyen, Duc Quang, Ronald Fedkiw, and Henrik Wann Jensen. "Physically Based Modeling and Animation of Fire." SIGGRAPH 2002.</p>
        <p>[4] Bridson, Robert. "Fluid Simulation for Computer Graphics." CRC Press, 2015.</p>
        <p>[5] Taichi Programming Language Documentation. https://docs.taichi-lang.org/</p>
    </div>

</body>
</html>
